"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[132],{5227:function(e,s,t){t.d(s,{$Bv:function(){return a9},$Sz:function(){return aJ},DcG:function(){return il},ENH:function(){return ia},En$:function(){return a8},Hqk:function(){return a3},K2m:function(){return ii},Kf0:function(){return aY},LdW:function(){return is},OjJ:function(){return aZ},S2d:function(){return id},U$$:function(){return a7},Zn:function(){return ie},hY6:function(){return i_},hZO:function(){return a0},lbf:function(){return a2},o$X:function(){return a$},t78:function(){return a5},tLj:function(){return a6},wiU:function(){return a4},z6E:function(){return a1}});var n=t(2511),a=t(8375),i=t(8577),o=t(3848),r=t(5118),l=t(222),c=t(1008);let{InferenceSession:d,Tensor:_,env:u}=l.ONNX,h={EncoderOnly:0,EncoderDecoder:1,Seq2Seq:2,Vision2Seq:3,DecoderOnly:4,MaskGeneration:5},m=new Map,p=new Map,g=new Map;async function f(e,s,t){let n="onnx/".concat(s).concat(t.quantized?"_quantized":"",".onnx"),a=await (0,i.st)(e,n,!0,t);try{return await d.create(a,{executionProviders:l.p})}catch(e){if(1===l.p.length&&"wasm"===l.p[0])throw e;return console.warn(e),console.warn("Something went wrong during model construction (most likely a missing operation). Using `wasm` as a fallback. "),await d.create(a,{executionProviders:["wasm"]})}}async function w(e,s){let t=function(e,s){let t=Object.create(null),n=[];for(let a of e.inputNames){let e=s[a];if(!(e instanceof r.es)){n.push(a);continue}t[a]=u.wasm.proxy?e.clone():e}if(n.length>0)throw Error('An error occurred during model execution: "Missing the following inputs: '.concat(n.join(", "),"."));let a=Object.keys(s).length,i=e.inputNames.length;if(a>i){let t=Object.keys(s).filter(s=>!e.inputNames.includes(s));console.warn("WARNING: Too many inputs were provided (".concat(a," > ").concat(i,'). The following inputs will be ignored: "').concat(t.join(", "),'".'))}return t}(e,s);try{let s=await e.run(t);return s=function e(s){for(let t in s)s[t]instanceof _?s[t]=new r.es(s[t]):"object"==typeof s[t]&&e(s[t]);return s}(s)}catch(e){throw console.error('An error occurred during model execution: "'.concat(e,'".')),console.error("Inputs given to model:",t),e}}function x(e,s){var t,n;let i=null!==(t=e.config.pad_token_id)&&void 0!==t?t:null,o=null!==(n=e.config.eos_token_id)&&void 0!==n?n:null;(0,a.Wy)(o)&&(o=[o]);let l=-1!==s.indexOf(i),c=null===o||!o.includes(i);if(!l||!c)return(0,r.r6)(s);{let e=BigInt64Array.from(s.data.map(e=>e!=i));return new r.es("int64",e,s.dims)}}function y(e,s,t){if(!e.inputNames.includes("position_ids"))return;let n=new BigInt64Array(s.attention_mask.data.length);for(let e=0;e<s.attention_mask.dims[0];++e){let t=e*s.attention_mask.dims[1],a=BigInt(0);for(let e=0;e<s.attention_mask.dims[1];++e){let i=t+e;0n===s.attention_mask.data[i]?n[i]=BigInt(1):(n[i]=a,a+=s.attention_mask.data[i])}}s.position_ids=new r.es("int64",n,s.attention_mask.dims),t&&(s.position_ids=s.position_ids.slice(null,-1).unsqueeze_(-1))}function M(e){return new r.es("bool",[e],[1])}async function v(e,s){let{encoder_outputs:t,past_key_values:n}=s;t||(t=(await C(e,s)).last_hidden_state);let a={input_ids:s.decoder_input_ids,encoder_hidden_states:t},i=!!n;e.decoder_merged_session.inputNames.includes("use_cache_branch")&&(a.use_cache_branch=M(i)),e.decoder_merged_session.inputNames.includes("encoder_attention_mask")&&(a.encoder_attention_mask=s.attention_mask),y(e.decoder_merged_session,a,i),e.addPastKeyValues(a,n);let o=await w(e.decoder_merged_session,a);return new iu({logits:o.logits,past_key_values:n=e.getPastKeyValues(o,n),encoder_outputs:t,...e.getAttentions(o)})}function k(e,s,t,n){var a,i,o,l;let c=[],d=0,_=null===(a=e.requires_attention_mask)||void 0===a||a,u=null!==(l=null!==(o=null!==(i=t.decoder_input_ids)&&void 0!==i?i:t.decoder_start_token_id)&&void 0!==o?o:t.bos_token_id)&&void 0!==l?l:t.eos_token_id;for(let t of(u instanceof r.es?u=u.tolist().flat():Array.isArray(u)||(u=[u]),s)){t.dims=[1,...t.dims];let s={inputs:t,encoder_outputs:null,prev_model_outputs:null,output_token_ids:u,done:!1,score:0,id:d++};_&&(s.attention_mask=x(e,t)),c.push(s)}return c}async function b(e,s){var t;let n=e.main_input_name,a=s.output_token_ids;s.prev_model_outputs&&(a=a.slice(-1));let i={[n]:s.inputs,decoder_input_ids:function(e){if(e instanceof r.es)return e;if(0===e.length)throw Error("items must be non-empty");if(!Array.isArray(e[0]))return new r.es("int64",BigInt64Array.from(e.map(e=>BigInt(e))),[1,e.length]);if(e.some(s=>s.length!==e[0].length))throw Error("Unable to create tensor, you should probably activate truncation and/or padding with 'padding=True' and/or 'truncation=True' to have batched tensors with the same length.");return new r.es("int64",BigInt64Array.from(e.flat().map(e=>BigInt(e))),[e.length,e[0].length])}(a),encoder_outputs:s.encoder_outputs,past_key_values:null===(t=s.prev_model_outputs)||void 0===t?void 0:t.past_key_values};s.attention_mask&&(i.attention_mask=s.attention_mask);let o=await e.forward(i);return s.prev_model_outputs=o,s.encoder_outputs=o.encoder_outputs,o}function S(e,s){e.output_token_ids=[...e.output_token_ids,s]}async function C(e,s){let t=Object.create(null);for(let n of e.session.inputNames)t[n]=s[n];return e.session.inputNames.includes("token_type_ids")&&!t.token_type_ids&&(t.token_type_ids=new r.es("int64",new BigInt64Array(t.input_ids.data.length),t.input_ids.dims)),await w(e.session,t)}async function F(e,s){let{input_ids:t,past_key_values:n,attention_mask:a}=s,i={input_ids:t,attention_mask:null!=a?a:x(e,t)},o=!!n;e.session.inputNames.includes("use_cache_branch")&&(i.use_cache_branch=M(o)),y(e.session,i,o),e.addPastKeyValues(i,n);let r=await w(e.session,i);return{logits:r.logits,past_key_values:n=e.getPastKeyValues(r,n)}}function L(e,s,t,n,a){let i=[],o=0;for(let t of s){let s,r=t.tolist().map(Number);t.dims=[1,...t.dims],a?(s=a[o]).dims=[1,...s.dims]:s=x(e,t);let l={input:t,model_input_ids:t,attention_mask:s,prev_model_outputs:null,output_token_ids:r,num_output_tokens:n,done:!1,score:0,id:o++};i.push(l)}return i}async function A(e,s){var t;let n=new BigInt64Array(s.output_token_ids.length).fill(1n),a={input_ids:s.model_input_ids,attention_mask:new r.es("int64",n,[1,n.length]),past_key_values:null===(t=s.prev_model_outputs)||void 0===t?void 0:t.past_key_values},i=await e.forward(a);return s.prev_model_outputs=i,i}function P(e,s){e.output_token_ids=[...e.output_token_ids,s],e.model_input_ids=new r.es("int64",[BigInt(s)],[1,1])}class E extends a.Ag{async dispose(){let e=[];for(let s of Object.keys(this)){let t=this[s];t instanceof d&&e.push(t.handler.dispose())}return await Promise.all(e)}static async from_pretrained(e){var s,t;let a,{quantized:o=!0,progress_callback:r=null,config:l=null,cache_dir:c=null,local_files_only:d=!1,revision:_="main",model_file_name:u=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},p={quantized:o,progress_callback:r,config:l,cache_dir:c,local_files_only:d,revision:_,model_file_name:u},w=g.get(this),x=m.get(w);return x===h.DecoderOnly?a=await Promise.all([n.z.from_pretrained(e,p),f(e,null!==(s=p.model_file_name)&&void 0!==s?s:"decoder_model_merged",p),(0,i.yM)(e,"generation_config.json",!1,p)]):x===h.Seq2Seq||x===h.Vision2Seq?a=await Promise.all([n.z.from_pretrained(e,p),f(e,"encoder_model",p),f(e,"decoder_model_merged",p),(0,i.yM)(e,"generation_config.json",!1,p)]):x===h.MaskGeneration?a=await Promise.all([n.z.from_pretrained(e,p),f(e,"vision_encoder",p),f(e,"prompt_encoder_mask_decoder",p)]):x===h.EncoderDecoder?a=await Promise.all([n.z.from_pretrained(e,p),f(e,"encoder_model",p),f(e,"decoder_model_merged",p)]):(x!==h.EncoderOnly&&console.warn("Model type for '".concat(null!=w?w:null==l?void 0:l.model_type,"' not found, assuming encoder-only architecture. Please report this at https://github.com/xenova/transformers.js/issues/new/choose.")),a=await Promise.all([n.z.from_pretrained(e,p),f(e,null!==(t=p.model_file_name)&&void 0!==t?t:"model",p)])),new this(...a)}async _call(e){return await this.forward(e)}async forward(e){return await this._forward(this,e)}_get_logits_processor(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=new o.Jm;if(null!==e.repetition_penalty&&1!==e.repetition_penalty&&n.push(new o.Jj(e.repetition_penalty)),null!==e.no_repeat_ngram_size&&e.no_repeat_ngram_size>0&&n.push(new o.jF(e.no_repeat_ngram_size)),null!==e.bad_words_ids&&n.push(new o.AE(e.bad_words_ids,e.eos_token_id)),null!==e.min_length&&null!==e.eos_token_id&&e.min_length>0&&n.push(new o.ez(e.min_length,e.eos_token_id)),null!==e.min_new_tokens&&null!==e.eos_token_id&&e.min_new_tokens>0&&n.push(new o.CJ(s,e.min_new_tokens,e.eos_token_id)),null!==e.forced_bos_token_id&&n.push(new o.C9(e.forced_bos_token_id)),null!==e.forced_eos_token_id&&n.push(new o.dZ(e.max_length,e.forced_eos_token_id)),null!==e.begin_suppress_tokens){let t=s>1||null===e.forced_bos_token_id?s:s+1;null!==e.forced_decoder_ids&&(t+=e.forced_decoder_ids[e.forced_decoder_ids.length-1][0]),n.push(new o.GU(e.begin_suppress_tokens,t))}return null!==e.forced_decoder_ids&&n.push(new o.E(e.forced_decoder_ids)),null!==t&&n.extend(t),n}_get_generation_config(e){let s=new o.aP(this.config);return"generation_config"in this&&Object.assign(s,this.generation_config),null!==e&&Object.assign(s,e),s}async generate(e){var s,t,n,i,l;let c,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,_=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,{inputs_attention_mask:u=null}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!this.can_generate){let e=g.get(this.constructor),a="The current model class (".concat(e,") is not compatible with `.generate()`, as it doesn't have a language model head."),i=this.config.model_type,o=null!==(n=null!==(t=null!==(s=aE.get(i))&&void 0!==s?s:aP.get(i))&&void 0!==t?t:aS.get(i))&&void 0!==n?n:aT.get(i);throw o&&(a+=" Please use the following class instead: '".concat(o[0],"'")),Error(a)}if(!(e instanceof r.es)&&!(0,a.fU)(e)&&!Array.isArray(e))throw Error('`inputs` must be a Tensor, TypedArray, or Array, but is "'.concat(e.constructor.name,'".'));if(this.config.is_encoder_decoder)c=0;else if(0===(c=e instanceof r.es?e.dims.at(-1):e.length))throw Error("Must supply a non-empty array of input token ids.");d=this._get_generation_config(d),_=null!=_?_:new o.Jm,_=this._get_logits_processor(d,c,_);let h=d.eos_token_id;null===h||Array.isArray(h)||(h=[h]);let m=1,p=1+(null!==(i=d.max_new_tokens)&&void 0!==i?i:1/0),f=Number.isInteger(d.max_length)&&(null!==(l=d.max_new_tokens)&&void 0!==l?l:null)===null,w=o.Z4.getSampler(d),x=this.getStartBeams(e,d,m,u);for(;x.some(e=>!e.done)&&m<p;){let e=[];for(let s of x){if(s.done){e.push(s);continue}if(f&&s.output_token_ids.length>=d.max_length){s.done=!0,e.push(s);continue}let t=await this.runBeam(s);d.output_attentions&&this.addAttentionsToBeam(s,t),d.output_scores;let n=t.logits.slice(null,-1,null);for(let[t,a]of(_(s.output_token_ids,n),w(n))){let n={...s};this.updateBeam(n,t),n.score+=a,h&&h.includes(t)&&(n.done=!0),e.push(n)}}++m,x=(e=this.groupBeams(e).map(e=>e.sort((e,s)=>s.score-e.score).slice(0,d.num_beams))).flat(),d.callback_function&&d.callback_function(x)}let y=this.groupBeams(x),M=e=>y.map(s=>d.num_return_sequences>1?s.slice(0,d.num_return_sequences).map(s=>s[e]):[s[0][e]]).flat(),v=M("output_token_ids");return d.return_dict_in_generate?{sequences:v,decoder_attentions:M("decoder_attentions"),cross_attentions:M("cross_attentions")}:v}addAttentionsToBeam(e,s){if(this.config.is_encoder_decoder){if(!s.cross_attentions||0===s.cross_attentions.length)throw Error("`output_attentions` is true, but the model did not produce cross-attentions. This is most likely because the model was not exported with `output_attentions=True`.");e.cross_attentions||(e.cross_attentions=[]),e.cross_attentions.push(s.cross_attentions)}if(!s.decoder_attentions||0===s.decoder_attentions.length)throw Error("`output_attentions` is true, but the model did not produce decoder-attentions. This is most likely because the model was not exported with `output_attentions=True`.");e.decoder_attentions||(e.decoder_attentions=[]),e.decoder_attentions.push(s.decoder_attentions)}groupBeams(e){let s=Object.create(null);for(let t of e)void 0===s[t.id]?s[t.id]=[t]:s[t.id].push(t);return Object.values(s)}getPastKeyValues(e,s){let t=Object.create(null);for(let n in e)if(n.startsWith("present")){let a=n.replace("present","past_key_values");s&&n.includes("encoder")?t[a]=s[a]:t[a]=e[n]}return t}getAttentions(e){let s=Object.create(null);for(let t of["cross_attentions","decoder_attentions"]){let n=[];for(let s in e)s.startsWith(t)&&(n[s.split(".").pop()]=e[s]);s[t]=n}return s}addPastKeyValues(e,s){if(s)Object.assign(e,s);else{var t;if(this.config.is_encoder_decoder&&(null===(t=this.add_encoder_pkv)||void 0===t||t)){let s=[1,this.num_encoder_heads,0,this.encoder_dim_kv],t=[1,this.num_decoder_heads,0,this.decoder_dim_kv];for(let n=0;n<this.num_decoder_layers;++n)e["past_key_values.".concat(n,".encoder.key")]=new r.es("float32",[],s),e["past_key_values.".concat(n,".encoder.value")]=new r.es("float32",[],s),e["past_key_values.".concat(n,".decoder.key")]=new r.es("float32",[],t),e["past_key_values.".concat(n,".decoder.value")]=new r.es("float32",[],t)}else if("falcon"===this.config.model_type){let s=[1*this.num_heads,0,this.dim_kv];for(let t=0;t<this.num_layers;++t)e["past_key_values.".concat(t,".key")]=new r.es("float32",[],s),e["past_key_values.".concat(t,".value")]=new r.es("float32",[],s)}else if(this.config.multi_query){let s=[1*this.num_heads,0,2*this.dim_kv];for(let t=0;t<this.num_layers;++t)e["past_key_values.".concat(t,".key_value")]=new r.es("float32",[],s)}else if("bloom"===this.config.model_type){let s=[1*this.num_heads,this.dim_kv,0],t=[1*this.num_heads,0,this.dim_kv];for(let n=0;n<this.num_layers;++n)e["past_key_values.".concat(n,".key")]=new r.es("float32",[],s),e["past_key_values.".concat(n,".value")]=new r.es("float32",[],t)}else{let s=[1,this.num_heads,0,this.dim_kv];for(let t=0;t<this.num_layers;++t)e["past_key_values.".concat(t,".key")]=new r.es("float32",[],s),e["past_key_values.".concat(t,".value")]=new r.es("float32",[],s)}}}getStartBeams(e,s,t,n){return this._getStartBeams(this,e,s,t,n)}async runBeam(e){return await this._runBeam(this,e)}updateBeam(e,s){return this._updateBeam(e,s)}constructor(e,s){super(),this.main_input_name="input_ids",this.config=e,this.session=s;let t=g.get(this.constructor),n=m.get(t);this.can_generate=!1,this._runBeam=null,this._getStartBeams=null,this._updateBeam=null,this._forward=null,n===h.DecoderOnly?(this.can_generate=!0,this._runBeam=A,this._getStartBeams=L,this._updateBeam=P,this._forward=F):n===h.Seq2Seq||n===h.Vision2Seq?(this.can_generate=!0,this._runBeam=b,this._getStartBeams=k,this._updateBeam=S,this._forward=v):(h.EncoderDecoder,this._forward=C)}}class O{}class B extends E{}class T extends B{}class D extends B{async _call(e){return new ig(await super._call(e))}}class I extends B{async _call(e){return new ih(await super._call(e))}}class q extends B{async _call(e){return new ip(await super._call(e))}}class N extends B{async _call(e){return new iw(await super._call(e))}}class G extends E{}class V extends G{}class z extends E{}class j extends z{}class W extends z{async _call(e){return new ig(await super._call(e))}}class R extends z{async _call(e){return new ih(await super._call(e))}}class Q extends z{async _call(e){return new ip(await super._call(e))}}class U extends z{async _call(e){return new iw(await super._call(e))}}class X extends E{}class K extends X{}class H extends X{async _call(e){return new ig(await super._call(e))}}class J extends X{async _call(e){return new ih(await super._call(e))}}class $ extends X{async _call(e){return new ip(await super._call(e))}}class Z extends X{async _call(e){return new iw(await super._call(e))}}class Y extends E{}class ee extends Y{}class es extends Y{async _call(e){return new ig(await super._call(e))}}class et extends Y{async _call(e){return new ih(await super._call(e))}}class en extends Y{async _call(e){return new ip(await super._call(e))}}class ea extends Y{async _call(e){return new iw(await super._call(e))}}class ei extends E{}class eo extends ei{}class er extends ei{async _call(e){return new ig(await super._call(e))}}class el extends ei{async _call(e){return new ih(await super._call(e))}}class ec extends ei{async _call(e){return new ip(await super._call(e))}}class ed extends ei{async _call(e){return new iw(await super._call(e))}}class e_ extends E{}class eu extends e_{}class eh extends e_{async _call(e){return new ig(await super._call(e))}}class em extends e_{async _call(e){return new ih(await super._call(e))}}class ep extends e_{async _call(e){return new ip(await super._call(e))}}class eg extends e_{async _call(e){return new iw(await super._call(e))}}class ef extends E{}class ew extends ef{}class ex extends ef{async _call(e){return new ig(await super._call(e))}}class ey extends ef{async _call(e){return new ih(await super._call(e))}}class eM extends ef{async _call(e){return new ip(await super._call(e))}}class ev extends ef{async _call(e){return new iw(await super._call(e))}}class ek extends E{}class eb extends ek{}class eS extends ek{async _call(e){return new ih(await super._call(e))}}class eC extends ek{async _call(e){return new ip(await super._call(e))}}class eF extends ek{async _call(e){return new iw(await super._call(e))}}class eL extends ek{async _call(e){return new ig(await super._call(e))}}class eA extends E{}class eP extends eA{}class eE extends eA{async _call(e){return new ig(await super._call(e))}}class eO extends eA{async _call(e){return new ih(await super._call(e))}}class eB extends eA{async _call(e){return new ip(await super._call(e))}}class eT extends E{}class eD extends eT{}class eI extends eT{async _call(e){return new ig(await super._call(e))}}class eq extends eT{async _call(e){return new ih(await super._call(e))}}class eN extends eT{async _call(e){return new iw(await super._call(e))}}class eG extends E{}class eV extends eG{}class ez extends eG{async _call(e){return new ig(await super._call(e))}}class ej extends eG{async _call(e){return new ih(await super._call(e))}}class eW extends eG{async _call(e){return new ip(await super._call(e))}}class eR extends eG{async _call(e){return new iw(await super._call(e))}}class eQ extends E{}class eU extends eQ{}class eX extends eQ{async _call(e){return new ig(await super._call(e))}}class eK extends eQ{async _call(e){return new ih(await super._call(e))}}class eH extends eQ{async _call(e){return new iw(await super._call(e))}}class eJ extends E{}class e$ extends eJ{}class eZ extends eJ{async _call(e){return new ih(await super._call(e))}}class eY extends eJ{async _call(e){return new iw(await super._call(e))}}class e0 extends eJ{async _call(e){return new ig(await super._call(e))}}class e2 extends E{}class e1 extends e2{}class e3 extends e2{constructor(e,s,t,n){super(e,s),this.decoder_merged_session=t,this.generation_config=n,this.num_decoder_layers=this.config.num_decoder_layers,this.num_decoder_heads=this.config.num_heads,this.decoder_dim_kv=this.config.d_kv,this.num_encoder_layers=this.config.num_layers,this.num_encoder_heads=this.config.num_heads,this.encoder_dim_kv=this.config.d_kv}}class e5 extends E{}class e4 extends e5{}class e6 extends e5{constructor(e,s,t,n){super(e,s),this.decoder_merged_session=t,this.generation_config=n,this.num_decoder_layers=this.config.num_decoder_layers,this.num_decoder_heads=this.config.num_heads,this.decoder_dim_kv=this.config.d_kv,this.num_encoder_layers=this.config.num_layers,this.num_encoder_heads=this.config.num_heads,this.encoder_dim_kv=this.config.d_kv}}class e8 extends E{}class e7 extends e8{}class e9 extends e8{constructor(e,s,t,n){super(e,s),this.decoder_merged_session=t,this.generation_config=n,this.num_decoder_layers=this.config.num_decoder_layers,this.num_decoder_heads=this.config.num_heads,this.decoder_dim_kv=this.config.d_kv,this.num_encoder_layers=this.config.num_layers,this.num_encoder_heads=this.config.num_heads,this.encoder_dim_kv=this.config.d_kv}}class se extends E{}class ss extends se{}class st extends se{constructor(e,s,t,n){super(e,s),this.decoder_merged_session=t,this.generation_config=n,this.num_decoder_layers=this.config.decoder_layers,this.num_decoder_heads=this.config.decoder_attention_heads,this.decoder_dim_kv=this.config.d_model/this.num_decoder_heads,this.num_encoder_layers=this.config.encoder_layers,this.num_encoder_heads=this.config.encoder_attention_heads,this.encoder_dim_kv=this.config.d_model/this.num_encoder_heads}}class sn extends se{async _call(e){return new ih(await super._call(e))}}class sa extends E{}class si extends sa{}class so extends sa{constructor(e,s,t,n){super(e,s),this.decoder_merged_session=t,this.generation_config=n,this.num_decoder_layers=this.config.decoder_layers,this.num_decoder_heads=this.config.decoder_attention_heads,this.decoder_dim_kv=this.config.d_model/this.num_decoder_heads,this.num_encoder_layers=this.config.encoder_layers,this.num_encoder_heads=this.config.encoder_attention_heads,this.encoder_dim_kv=this.config.d_model/this.num_encoder_heads}}class sr extends sa{async _call(e){return new ih(await super._call(e))}}class sl extends sa{constructor(e,s,t){super(e,s),this.generation_config=t,this.num_decoder_layers=this.config.decoder_layers,this.num_decoder_heads=this.config.decoder_attention_heads,this.decoder_dim_kv=this.config.d_model/this.num_decoder_heads,this.num_encoder_layers=this.config.encoder_layers,this.num_encoder_heads=this.config.encoder_attention_heads,this.encoder_dim_kv=this.config.d_model/this.num_encoder_heads}}class sc extends E{}class sd extends sc{}class s_ extends sc{constructor(e,s,t,n){super(e,s),this.decoder_merged_session=t,this.generation_config=n,this.num_decoder_layers=this.config.decoder_layers,this.num_decoder_heads=this.config.decoder_attention_heads,this.decoder_dim_kv=this.config.d_model/this.num_decoder_heads,this.num_encoder_layers=this.config.encoder_layers,this.num_encoder_heads=this.config.encoder_attention_heads,this.encoder_dim_kv=this.config.d_model/this.num_encoder_heads}}class su extends E{}class sh extends su{}class sm extends su{constructor(e,s,t,n){super(e,s),this.decoder_merged_session=t,this.generation_config=n,this.num_decoder_layers=this.config.decoder_layers,this.num_decoder_heads=this.config.decoder_attention_heads,this.decoder_dim_kv=this.config.d_model/this.num_decoder_heads,this.num_encoder_layers=this.config.encoder_layers,this.num_encoder_heads=this.config.encoder_attention_heads,this.encoder_dim_kv=this.config.d_model/this.num_encoder_heads}}class sp extends E{}class sg extends sp{}class sf extends sp{async _call(e){return new ig(await super._call(e))}}class sw extends sp{async _call(e){return new ih(await super._call(e))}}class sx extends sp{async _call(e){return new ip(await super._call(e))}}class sy extends sp{async _call(e){return new iw(await super._call(e))}}class sM extends E{}class sv extends sM{}class sk extends sM{async _call(e){return new ig(await super._call(e))}}class sb extends sM{async _call(e){return new ih(await super._call(e))}}class sS extends sM{async _call(e){return new ip(await super._call(e))}}class sC extends sM{async _call(e){return new iw(await super._call(e))}}class sF extends E{}class sL extends sF{}class sA extends sF{async _call(e){return new ig(await super._call(e))}}class sP extends sF{async _call(e){return new ih(await super._call(e))}}class sE extends sF{async _call(e){return new ip(await super._call(e))}}class sO extends sF{async _call(e){return new iw(await super._call(e))}}class sB extends E{}class sT extends sB{}class sD extends sB{}class sI extends E{}class sq extends sI{}class sN extends sI{async generate(e){var s,t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(null!==(t=(s=n=this._get_generation_config(n)).return_timestamps)&&void 0!==t||(s.return_timestamps=!1),n.return_timestamps&&(a=[new o.Pg(n)]),n.return_token_timestamps&&(n.output_attentions=!0,n.return_dict_in_generate=!0,"translate"===n.task&&console.warn("Token-level timestamps may not be reliable for task 'translate'."),!n.alignment_heads))throw Error("Model generation config has no `alignment_heads`, token-level timestamps not available. See https://gist.github.com/hollance/42e32852f24243b748ae6bc1f985b13a on how to add this property to the generation config.");let i=await super.generate(e,n,a);return n.return_token_timestamps&&n.alignment_heads&&(i.token_timestamps=this._extract_token_timestamps(i,n.alignment_heads,n.num_frames)),i}_extract_token_timestamps(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.02;if(!e.cross_attentions)throw Error("Model outputs must contain cross attentions to extract timestamps. This is most likely because the model was not exported with `output_attentions=True`.");let i=this.config.median_filter_width;void 0===i&&(console.warn("Model config has no `median_filter_width`, using default value of 7."),i=7);let o=e.cross_attentions.map(e=>{let n=Array.from({length:this.config.decoder_layers},(s,t)=>(0,r.d3)(e.map(e=>e[t]),2)),a=(0,r.kn)(s.map(e=>{let[s,a]=e;return t?n[s].slice(null,a,null,[0,t]):n[s].slice(null,a)}));a=a.transpose(1,0,2,3);let[o,l]=(0,r.f3)(a,-2,0,!0),d=a.clone();for(let e=0;e<d.dims[0];++e){let s=d[e];for(let t=0;t<s.dims[0];++t){let n=s[t],a=o[e][t][0],r=l[e][t][0];for(let e=0;e<n.dims[0];++e){let s=n[e];for(let e=0;e<s.data.length;++e)s.data[e]=(s.data[e]-r.data[e])/a.data[e];s.data.set((0,c.qCb)(s.data,i))}}}return(0,r.J6)(d,1)}),l=[e.sequences.length,e.sequences[0].length],d=new r.es("float32",new Float32Array(l[0]*l[1]),l);for(let e=0;e<l[0];++e){let s=o[e].neg().squeeze_(0),[t,i]=(0,r.Ks)(s),l=Array.from({length:t.length-1},(e,s)=>t[s+1]-t[s]),c=(0,a.eG)([1],l).map(e=>!!e),_=[];for(let e=0;e<c.length;++e)c[e]&&_.push(i[e]*n);d[e].data.set(_,1)}return d}constructor(e,s,t,n){super(e,s),this.requires_attention_mask=!1,this.main_input_name="input_features",this.decoder_merged_session=t,this.generation_config=n,this.num_decoder_layers=this.config.decoder_layers,this.num_decoder_heads=this.config.decoder_attention_heads,this.decoder_dim_kv=this.config.d_model/this.num_decoder_heads,this.num_encoder_layers=this.config.encoder_layers,this.num_encoder_heads=this.config.encoder_attention_heads,this.encoder_dim_kv=this.config.d_model/this.num_encoder_heads}}class sG extends E{constructor(e,s,t,n){var a;super(e,s),this.main_input_name="pixel_values",this.decoder_merged_session=t,this.generation_config=n;let i=this.config.encoder,o=this.config.decoder,r=i.model_type;(null!==(a=av.get(r))&&void 0!==a?a:ak.get(r))||console.warn("Model type for encoder '".concat(r,"' not found, assuming encoder-only architecture. Please report this at https://github.com/xenova/transformers.js/issues/new/choose."));let l=aE.get(o.model_type);if(!l)throw Error('Unable to construct `VisionEncoderDecoder` due to unsupported decoder: "'.concat(this.config.decoder.model_type,'"'));let c=new l[1](o,t,n);this.add_encoder_pkv="num_decoder_layers"in c,this.add_encoder_pkv?(this.num_decoder_layers=c.num_decoder_layers,this.num_decoder_heads=c.num_decoder_heads,this.decoder_dim_kv=c.decoder_dim_kv,this.num_encoder_layers=c.num_encoder_layers,this.num_encoder_heads=c.num_encoder_heads,this.encoder_dim_kv=c.encoder_dim_kv):(this.num_layers=c.num_layers,this.num_heads=c.num_heads,this.dim_kv=c.dim_kv)}}class sV extends E{}class sz extends sV{}class sj extends sV{static async from_pretrained(e){var s;let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null!==(s=t.model_file_name)&&void 0!==s||(t.model_file_name="text_model"),super.from_pretrained(e,t)}}class sW extends sV{static async from_pretrained(e){var s;let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null!==(s=t.model_file_name)&&void 0!==s||(t.model_file_name="vision_model"),super.from_pretrained(e,t)}}class sR extends E{}class sQ extends sR{}class sU extends sR{static async from_pretrained(e){var s;let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null!==(s=t.model_file_name)&&void 0!==s||(t.model_file_name="text_model"),super.from_pretrained(e,t)}}class sX extends sV{static async from_pretrained(e){var s;let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null!==(s=t.model_file_name)&&void 0!==s||(t.model_file_name="vision_model"),super.from_pretrained(e,t)}}class sK extends E{}class sH extends sK{}class sJ extends E{}class s$ extends sJ{}class sZ extends sJ{}class sY extends E{constructor(e,s,t){super(e,s),this.generation_config=t,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=this.config.n_head,this.num_layers=this.config.n_layer,this.dim_kv=this.config.n_embd/this.num_heads}}class s0 extends sY{}class s2 extends sY{}class s1 extends E{constructor(e,s,t){super(e,s),this.generation_config=t,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=this.config.num_heads,this.num_layers=this.config.num_layers,this.dim_kv=this.config.hidden_size/this.num_heads}}class s3 extends s1{}class s5 extends s1{}class s4 extends E{constructor(e,s,t){super(e,s),this.generation_config=t,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=this.config.num_attention_heads,this.num_layers=this.config.num_hidden_layers,this.dim_kv=this.config.hidden_size/this.num_heads}}class s6 extends s4{}class s8 extends s4{}class s7 extends E{constructor(e,s,t){super(e,s),this.generation_config=t,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=this.config.n_head,this.num_layers=this.config.n_layer,this.dim_kv=this.config.n_embd/this.num_heads}}class s9 extends s7{}class te extends s7{}class ts extends E{constructor(e,s,t){super(e,s),this.generation_config=t,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=this.config.n_head,this.num_layers=this.config.n_layer,this.dim_kv=this.config.n_embd/this.num_heads}}class tt extends ts{}class tn extends ts{}class ta extends E{constructor(e,s,t){super(e,s),this.generation_config=t,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=this.config.n_head,this.num_layers=this.config.n_layer,this.dim_kv=this.config.n_embd/this.num_heads}}class ti extends ta{}class to extends ta{}class tr extends E{constructor(e,s,t){var n;super(e,s),this.generation_config=t,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=null!==(n=this.config.num_key_value_heads)&&void 0!==n?n:this.config.num_attention_heads,this.num_layers=this.config.num_hidden_layers,this.dim_kv=this.config.hidden_size/this.config.num_attention_heads}}class tl extends tr{}class tc extends tr{}class td extends E{constructor(e,s,t){var n;super(e,s),this.generation_config=t,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=null!==(n=this.config.num_key_value_heads)&&void 0!==n?n:this.config.num_attention_heads,this.num_layers=this.config.num_hidden_layers,this.dim_kv=this.config.hidden_size/this.config.num_attention_heads}}class t_ extends td{}class tu extends td{}class th extends E{constructor(e,s,t){super(e,s),this.generation_config=t,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=this.config.num_attention_heads,this.num_layers=this.config.num_hidden_layers,this.dim_kv=this.config.hidden_size/this.num_heads}}class tm extends th{}class tp extends th{}class tg extends E{constructor(e,s,t){super(e,s),this.generation_config=t,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=this.config.n_head,this.num_layers=this.config.n_layer,this.dim_kv=this.config.hidden_size/this.num_heads}}class tf extends tg{}class tw extends tg{}class tx extends E{constructor(e,s,t){super(e,s),this.generation_config=t,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=this.config.n_heads,this.num_layers=this.config.n_layers,this.dim_kv=this.config.d_model/this.num_heads}}class ty extends tx{}class tM extends tx{}class tv extends E{constructor(e,s,t){super(e,s),this.generation_config=t,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=this.config.num_attention_heads,this.num_layers=this.config.num_hidden_layers,this.dim_kv=this.config.hidden_size/this.num_heads}}class tk extends tv{}class tb extends tv{}class tS extends E{}class tC extends tS{}class tF extends tS{async _call(e){return new ih(await super._call(e))}}class tL extends E{}class tA extends tL{async _call(e){return new iy(await super._call(e))}}class tP extends E{}class tE extends tP{}class tO extends tP{async _call(e){return new ih(await super._call(e))}}class tB extends E{}class tT extends tB{}class tD extends tB{}class tI extends E{}class tq extends tI{}class tN extends tI{}class tG extends E{}class tV extends tG{}class tz extends tG{async _call(e){return new ih(await super._call(e))}}class tj extends E{}class tW extends tj{}class tR extends tj{async _call(e){return new tU(await super._call(e))}}class tQ extends tj{async _call(e){return new tX(await super._call(e))}}class tU extends O{constructor({logits:e,pred_boxes:s}){super(),this.logits=e,this.pred_boxes=s}}class tX extends O{constructor({logits:e,pred_boxes:s,pred_masks:t}){super(),this.logits=e,this.pred_boxes=s,this.pred_masks=t}}class tK extends E{}class tH extends tK{}class tJ extends tK{async _call(e){return new t$(await super._call(e))}}class t$ extends tU{}class tZ extends E{}class tY extends tZ{}class t0 extends tZ{async _call(e){return new ih(await super._call(e))}}class t2 extends E{}class t1 extends t2{}class t3 extends t2{async _call(e){return new ih(await super._call(e))}}class t5 extends E{}class t4 extends t5{}class t6 extends t5{async _call(e){return new ih(await super._call(e))}}class t8 extends E{}class t7 extends t8{}class t9 extends t8{}class ne extends E{}class ns extends ne{}class nt extends ne{}class nn extends E{}class na extends nn{}class ni extends E{}class no extends ni{}class nr extends ni{}class nl extends E{}class nc extends nl{}class nd extends E{}class n_ extends nd{}class nu extends nd{async _call(e){return new ih(await super._call(e))}}class nh extends E{}class nm extends nh{}class np extends nh{async _call(e){return new ih(await super._call(e))}}class ng extends E{}class nf extends ng{}class nw extends ng{async _call(e){return new ih(await super._call(e))}}class nx extends E{}class ny extends nx{}class nM extends nx{async _call(e){return new nv(await super._call(e))}}class nv extends O{constructor({logits:e,pred_boxes:s}){super(),this.logits=e,this.pred_boxes=s}}class nk extends E{}class nb extends nk{async get_image_embeddings(e){let{pixel_values:s}=e;return await C(this,{pixel_values:s})}async forward(e){if(e.image_embeddings&&e.image_positional_embeddings||(e={...e,...await this.get_image_embeddings(e)}),!e.input_labels){let s=e.input_points.dims.slice(0,-1),t=s.reduce((e,s)=>e*s,1);e.input_labels=new r.es("int64",new BigInt64Array(t).fill(1n),s)}return await w(this.prompt_encoder_mask_decoder,{input_points:e.input_points,input_labels:e.input_labels,image_embeddings:e.image_embeddings,image_positional_embeddings:e.image_positional_embeddings})}async _call(e){return new nS(await super._call(e))}constructor(e,s,t){super(e,s),this.prompt_encoder_mask_decoder=t}}class nS extends O{constructor({iou_scores:e,pred_masks:s}){super(),this.iou_scores=e,this.pred_masks=s}}class nC extends E{}class nF extends nC{}class nL extends nC{constructor(e,s,t,n){super(e,s),this.decoder_merged_session=t,this.generation_config=n,this.num_decoder_layers=this.config.decoder_layers,this.num_decoder_heads=this.config.decoder_attention_heads,this.decoder_dim_kv=this.config.d_model/this.num_decoder_heads,this.num_encoder_layers=this.config.encoder_layers,this.num_encoder_heads=this.config.encoder_attention_heads,this.encoder_dim_kv=this.config.d_model/this.num_encoder_heads}}class nA extends E{}class nP extends nA{}class nE extends nA{constructor(e,s,t,n){super(e,s),this.decoder_merged_session=t,this.generation_config=n,this.num_decoder_layers=this.config.decoder_layers,this.num_decoder_heads=this.config.decoder_attention_heads,this.decoder_dim_kv=this.config.d_model/this.num_decoder_heads,this.num_encoder_layers=this.config.encoder_layers,this.num_encoder_heads=this.config.encoder_attention_heads,this.encoder_dim_kv=this.config.d_model/this.num_encoder_heads}}class nO extends E{}class nB extends nO{}class nT extends nO{async _call(e){return new ix(await super._call(e))}}class nD extends nO{async _call(e){return new ih(await super._call(e))}}class nI extends nO{async _call(e){return new ip(await super._call(e))}}class nq extends E{}class nN extends nq{}class nG extends nq{async _call(e){return new ix(await super._call(e))}}class nV extends nq{async _call(e){return new ih(await super._call(e))}}class nz extends E{}class nj extends nz{}class nW extends nz{async _call(e){return new ix(await super._call(e))}}class nR extends nz{async _call(e){return new ih(await super._call(e))}}class nQ extends nz{async _call(e){return new ip(await super._call(e))}}class nU extends E{}class nX extends nU{}class nK extends nU{async _call(e){return new ix(await super._call(e))}}class nH extends nU{async _call(e){return new ih(await super._call(e))}}class nJ extends nO{}class n$ extends nO{async _call(e){return new ix(await super._call(e))}}class nZ extends nO{async _call(e){return new ih(await super._call(e))}}class nY extends E{}class n0 extends nY{}class n2 extends nY{async _call(e){return new ix(await super._call(e))}}class n1 extends nY{async _call(e){return new ih(await super._call(e))}}class n3 extends nY{async _call(e){return new im(await super._call(e))}}class n5 extends nY{async _call(e){return new ip(await super._call(e))}}class n4 extends E{}class n6 extends n4{}class n8 extends n4{async generate_speech(e,s){let{threshold:t=.5,minlenratio:n=0,maxlenratio:a=20,vocoder:i=null}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{encoder_outputs:o,encoder_attention_mask:l}=await C(this,{input_ids:e}),c=o.dims[1]/this.config.reduction_factor,d=Math.floor(c*a),_=Math.floor(c*n),u=this.config.num_mel_bins,h=[],m=null,p=null,g=0;for(;;){++g;let e={use_cache_branch:M(!!p),output_sequence:p?p.output_sequence_out:new r.es("float32",new Float32Array(u),[1,1,u]),encoder_attention_mask:l,speaker_embeddings:s,encoder_hidden_states:o};this.addPastKeyValues(e,m),p=await w(this.decoder_merged_session,e),m=this.getPastKeyValues(p,m);let{prob:n,spectrum:a}=p;if(h.push(a),g>=_&&(Array.from(n.data).filter(e=>e>=t).length>0||g>=d))break}let f=(0,r.d3)(h),{waveform:x}=await w(i.session,{spectrogram:f});return{spectrogram:f,waveform:x}}constructor(e,s,t,n){super(e,s),this.decoder_merged_session=t,this.generation_config=n,this.num_decoder_layers=this.config.decoder_layers,this.num_decoder_heads=this.config.decoder_attention_heads,this.decoder_dim_kv=this.config.hidden_size/this.num_decoder_heads,this.num_encoder_layers=this.config.encoder_layers,this.num_encoder_heads=this.config.encoder_attention_heads,this.encoder_dim_kv=this.config.hidden_size/this.num_encoder_heads}}class n7 extends E{constructor(...e){super(...e),this.main_input_name="spectrogram"}}class n9 extends E{constructor(e,s,t){super(e,s),this.generation_config=t,this.config.pad_token_id=this.config.eos_token_id,this.num_encoder_layers=this.num_decoder_layers=this.config.decoder_layers,this.num_encoder_heads=this.num_decoder_heads=this.config.decoder_attention_heads,this.encoder_dim_kv=this.decoder_dim_kv=this.config.d_model/this.num_decoder_heads}}class ae extends n9{}class as extends E{constructor(e,s,t){super(e,s),this.generation_config=t,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=this.config.num_key_value_heads,this.num_layers=this.config.num_hidden_layers,this.dim_kv=this.config.hidden_size/this.config.num_attention_heads}}class at extends as{}class an extends as{}class aa extends E{constructor(e,s,t){super(e,s),this.generation_config=t,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=this.config.num_key_value_heads,this.num_layers=this.config.num_hidden_layers,this.dim_kv=this.config.hidden_size/this.config.num_attention_heads}}class ai extends aa{}class ao extends aa{}class ar extends E{constructor(e,s,t){super(e,s),this.generation_config=t,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=this.config.num_attention_heads,this.num_layers=this.config.num_hidden_layers,this.dim_kv=this.config.hidden_size/this.config.num_attention_heads}}class al extends ar{}class ac extends ar{}class ad extends E{}class a_ extends ad{}class au extends ad{static async from_pretrained(e){var s;let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null!==(s=t.model_file_name)&&void 0!==s||(t.model_file_name="text_model"),super.from_pretrained(e,t)}}class ah extends ad{static async from_pretrained(e){var s;let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null!==(s=t.model_file_name)&&void 0!==s||(t.model_file_name="audio_model"),super.from_pretrained(e,t)}}class am extends E{}class ap extends am{async _call(e){return new iM(await super._call(e))}}class ag extends E{}class af extends ag{}class aw extends ag{}class ax extends E{constructor(e,s,t){super(e,s),this.generation_config=t,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=this.config.num_attention_heads,this.num_layers=this.config.num_hidden_layers,this.dim_kv=this.config.hidden_size/this.num_heads}}class ay extends ax{}class aM{static async from_pretrained(e){let{quantized:s=!0,progress_callback:t=null,config:a=null,cache_dir:i=null,local_files_only:o=!1,revision:r="main",model_file_name:l=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c={quantized:s,progress_callback:t,config:a,cache_dir:i,local_files_only:o,revision:r,model_file_name:l};if(a=await n.z.from_pretrained(e,c),c.config||(c.config=a),!this.MODEL_CLASS_MAPPINGS)throw Error("`MODEL_CLASS_MAPPINGS` not implemented for this type of `AutoClass`: "+this.name);for(let s of this.MODEL_CLASS_MAPPINGS){let t=s.get(a.model_type);if(t)return await t[1].from_pretrained(e,c)}if(this.BASE_IF_FAIL)return console.warn('Unknown model class "'.concat(a.model_type,'", attempting to construct from base class.')),await E.from_pretrained(e,c);throw Error("Unsupported model type: ".concat(a.model_type))}}aM.MODEL_CLASS_MAPPINGS=null,aM.BASE_IF_FAIL=!1;let av=new Map([["bert",["BertModel",T]],["nomic_bert",["NomicBertModel",V]],["roformer",["RoFormerModel",j]],["electra",["ElectraModel",ee]],["esm",["EsmModel",eP]],["convbert",["ConvBertModel",K]],["camembert",["CamembertModel",eo]],["deberta",["DebertaModel",eu]],["deberta-v2",["DebertaV2Model",ew]],["mpnet",["MPNetModel",eV]],["albert",["AlbertModel",e$]],["distilbert",["DistilBertModel",eb]],["roberta",["RobertaModel",sg]],["xlm",["XLMModel",sv]],["xlm-roberta",["XLMRobertaModel",sL]],["clap",["ClapModel",a_]],["clip",["CLIPModel",sz]],["clipseg",["CLIPSegModel",s$]],["chinese_clip",["ChineseCLIPModel",sH]],["siglip",["SiglipModel",sQ]],["mobilebert",["MobileBertModel",eD]],["squeezebert",["SqueezeBertModel",eU]],["wav2vec2",["Wav2Vec2Model",nB]],["wav2vec2-bert",["Wav2Vec2BertModel",nX]],["unispeech",["UniSpeechModel",nN]],["unispeech-sat",["UniSpeechSatModel",nj]],["hubert",["HubertModel",nJ]],["wavlm",["WavLMModel",n0]],["audio-spectrogram-transformer",["ASTModel",sT]],["vits",["VitsModel",ap]],["detr",["DetrModel",tW]],["table-transformer",["TableTransformerModel",tH]],["vit",["ViTModel",tC]],["mobilevit",["MobileViTModel",tE]],["owlvit",["OwlViTModel",tT]],["owlv2",["Owlv2Model",tq]],["beit",["BeitModel",tV]],["deit",["DeiTModel",tY]],["convnext",["ConvNextModel",n_]],["convnextv2",["ConvNextV2Model",nm]],["dinov2",["Dinov2Model",nf]],["resnet",["ResNetModel",t1]],["swin",["SwinModel",t4]],["swin2sr",["Swin2SRModel",t7]],["donut-swin",["DonutSwinModel",nc]],["yolos",["YolosModel",ny]],["dpt",["DPTModel",ns]],["glpn",["GLPNModel",no]],["hifigan",["SpeechT5HifiGan",n7]]]),ak=new Map([["t5",["T5Model",e1]],["longt5",["LongT5Model",e4]],["mt5",["MT5Model",e7]],["bart",["BartModel",ss]],["mbart",["MBartModel",si]],["marian",["MarianModel",nF]],["whisper",["WhisperModel",sq]],["m2m_100",["M2M100Model",nP]],["blenderbot",["BlenderbotModel",sd]],["blenderbot-small",["BlenderbotSmallModel",sh]]]),ab=new Map([["bloom",["BloomModel",tf]],["gpt2",["GPT2Model",s0]],["gptj",["GPTJModel",s9]],["gpt_bigcode",["GPTBigCodeModel",tt]],["gpt_neo",["GPTNeoModel",s3]],["gpt_neox",["GPTNeoXModel",s6]],["codegen",["CodeGenModel",ti]],["llama",["LlamaModel",tl]],["qwen2",["Qwen2Model",t_]],["phi",["PhiModel",tm]],["mpt",["MptModel",ty]],["opt",["OPTModel",tk]],["mistral",["MistralModel",at]],["starcoder2",["Starcoder2Model",ai]],["falcon",["FalconModel",al]]]),aS=new Map([["speecht5",["SpeechT5ForSpeechToText",n6]],["whisper",["WhisperForConditionalGeneration",sN]]]),aC=new Map([["speecht5",["SpeechT5ForTextToSpeech",n8]]]),aF=new Map([["vits",["VitsModel",ap]]]),aL=new Map([["bert",["BertForSequenceClassification",I]],["roformer",["RoFormerForSequenceClassification",R]],["electra",["ElectraForSequenceClassification",et]],["esm",["EsmForSequenceClassification",eO]],["convbert",["ConvBertForSequenceClassification",J]],["camembert",["CamembertForSequenceClassification",el]],["deberta",["DebertaForSequenceClassification",em]],["deberta-v2",["DebertaV2ForSequenceClassification",ey]],["mpnet",["MPNetForSequenceClassification",ej]],["albert",["AlbertForSequenceClassification",eZ]],["distilbert",["DistilBertForSequenceClassification",eS]],["roberta",["RobertaForSequenceClassification",sw]],["xlm",["XLMForSequenceClassification",sb]],["xlm-roberta",["XLMRobertaForSequenceClassification",sP]],["bart",["BartForSequenceClassification",sn]],["mbart",["MBartForSequenceClassification",sr]],["mobilebert",["MobileBertForSequenceClassification",eq]],["squeezebert",["SqueezeBertForSequenceClassification",eK]]]),aA=new Map([["bert",["BertForTokenClassification",q]],["roformer",["RoFormerForTokenClassification",Q]],["electra",["ElectraForTokenClassification",en]],["esm",["EsmForTokenClassification",eB]],["convbert",["ConvBertForTokenClassification",$]],["camembert",["CamembertForTokenClassification",ec]],["deberta",["DebertaForTokenClassification",ep]],["deberta-v2",["DebertaV2ForTokenClassification",eM]],["mpnet",["MPNetForTokenClassification",eW]],["distilbert",["DistilBertForTokenClassification",eC]],["roberta",["RobertaForTokenClassification",sx]],["xlm",["XLMForTokenClassification",sS]],["xlm-roberta",["XLMRobertaForTokenClassification",sE]]]),aP=new Map([["t5",["T5ForConditionalGeneration",e3]],["longt5",["LongT5ForConditionalGeneration",e6]],["mt5",["MT5ForConditionalGeneration",e9]],["bart",["BartForConditionalGeneration",st]],["mbart",["MBartForConditionalGeneration",so]],["marian",["MarianMTModel",nL]],["m2m_100",["M2M100ForConditionalGeneration",nE]],["blenderbot",["BlenderbotForConditionalGeneration",s_]],["blenderbot-small",["BlenderbotSmallForConditionalGeneration",sm]]]),aE=new Map([["bloom",["BloomForCausalLM",tw]],["gpt2",["GPT2LMHeadModel",s2]],["gptj",["GPTJForCausalLM",te]],["gpt_bigcode",["GPTBigCodeForCausalLM",tn]],["gpt_neo",["GPTNeoForCausalLM",s5]],["gpt_neox",["GPTNeoXForCausalLM",s8]],["codegen",["CodeGenForCausalLM",to]],["llama",["LlamaForCausalLM",tc]],["qwen2",["Qwen2ForCausalLM",tu]],["phi",["PhiForCausalLM",tp]],["mpt",["MptForCausalLM",tM]],["opt",["OPTForCausalLM",tb]],["mbart",["MBartForCausalLM",sl]],["mistral",["MistralForCausalLM",an]],["starcoder2",["Starcoder2ForCausalLM",ao]],["falcon",["FalconForCausalLM",ac]],["trocr",["TrOCRForCausalLM",ae]],["stablelm",["StableLmForCausalLM",ay]]]),aO=new Map([["bert",["BertForMaskedLM",D]],["roformer",["RoFormerForMaskedLM",W]],["electra",["ElectraForMaskedLM",es]],["esm",["EsmForMaskedLM",eE]],["convbert",["ConvBertForMaskedLM",H]],["camembert",["CamembertForMaskedLM",er]],["deberta",["DebertaForMaskedLM",eh]],["deberta-v2",["DebertaV2ForMaskedLM",ex]],["mpnet",["MPNetForMaskedLM",ez]],["albert",["AlbertForMaskedLM",e0]],["distilbert",["DistilBertForMaskedLM",eL]],["roberta",["RobertaForMaskedLM",sf]],["xlm",["XLMWithLMHeadModel",sk]],["xlm-roberta",["XLMRobertaForMaskedLM",sA]],["mobilebert",["MobileBertForMaskedLM",eI]],["squeezebert",["SqueezeBertForMaskedLM",eX]]]),aB=new Map([["bert",["BertForQuestionAnswering",N]],["roformer",["RoFormerForQuestionAnswering",U]],["electra",["ElectraForQuestionAnswering",ea]],["convbert",["ConvBertForQuestionAnswering",Z]],["camembert",["CamembertForQuestionAnswering",ed]],["deberta",["DebertaForQuestionAnswering",eg]],["deberta-v2",["DebertaV2ForQuestionAnswering",ev]],["mpnet",["MPNetForQuestionAnswering",eR]],["albert",["AlbertForQuestionAnswering",eY]],["distilbert",["DistilBertForQuestionAnswering",eF]],["roberta",["RobertaForQuestionAnswering",sy]],["xlm",["XLMForQuestionAnswering",sC]],["xlm-roberta",["XLMRobertaForQuestionAnswering",sO]],["mobilebert",["MobileBertForQuestionAnswering",eN]],["squeezebert",["SqueezeBertForQuestionAnswering",eH]]]),aT=new Map([["vision-encoder-decoder",["VisionEncoderDecoderModel",sG]]]),aD=new Map([["vision-encoder-decoder",["VisionEncoderDecoderModel",sG]]]),aI=new Map([["vit",["ViTForImageClassification",tF]],["mobilevit",["MobileViTForImageClassification",tO]],["beit",["BeitForImageClassification",tz]],["deit",["DeiTForImageClassification",t0]],["convnext",["ConvNextForImageClassification",nu]],["convnextv2",["ConvNextV2ForImageClassification",np]],["dinov2",["Dinov2ForImageClassification",nw]],["resnet",["ResNetForImageClassification",t3]],["swin",["SwinForImageClassification",t6]],["segformer",["SegformerForImageClassification",af]]]),aq=new Map([["detr",["DetrForObjectDetection",tR]],["table-transformer",["TableTransformerForObjectDetection",tJ]],["yolos",["YolosForObjectDetection",nM]]]),aN=new Map([["owlvit",["OwlViTForObjectDetection",tD]],["owlv2",["Owlv2ForObjectDetection",tN]]]),aG=new Map([["detr",["DetrForSegmentation",tQ]],["clipseg",["CLIPSegForImageSegmentation",sZ]]]),aV=new Map([["segformer",["SegformerForSemanticSegmentation",aw]]]),az=new Map([["sam",["SamModel",nb]]]),aj=new Map([["wav2vec2",["Wav2Vec2ForCTC",nT]],["wav2vec2-bert",["Wav2Vec2BertForCTC",nK]],["unispeech",["UniSpeechForCTC",nG]],["unispeech-sat",["UniSpeechSatForCTC",nW]],["wavlm",["WavLMForCTC",n2]],["hubert",["HubertForCTC",n$]]]),aW=new Map([["wav2vec2",["Wav2Vec2ForSequenceClassification",nD]],["wav2vec2-bert",["Wav2Vec2BertForSequenceClassification",nH]],["unispeech",["UniSpeechForSequenceClassification",nV]],["unispeech-sat",["UniSpeechSatForSequenceClassification",nR]],["wavlm",["WavLMForSequenceClassification",n1]],["hubert",["HubertForSequenceClassification",nZ]],["audio-spectrogram-transformer",["ASTForAudioClassification",sD]]]),aR=new Map([["wavlm",["WavLMForXVector",n3]]]),aQ=new Map([["unispeech-sat",["UniSpeechSatForAudioFrameClassification",nQ]],["wavlm",["WavLMForAudioFrameClassification",n5]],["wav2vec2",["Wav2Vec2ForAudioFrameClassification",nI]]]),aU=new Map([["vitmatte",["VitMatteForImageMatting",tA]]]),aX=new Map([["swin2sr",["Swin2SRForImageSuperResolution",t9]]]),aK=new Map([["dpt",["DPTForDepthEstimation",nt]],["depth_anything",["DepthAnythingForDepthEstimation",na]],["glpn",["GLPNForDepthEstimation",nr]]]),aH=[[av,h.EncoderOnly],[ak,h.EncoderDecoder],[ab,h.DecoderOnly],[aL,h.EncoderOnly],[aA,h.EncoderOnly],[aP,h.Seq2Seq],[aS,h.Seq2Seq],[aE,h.DecoderOnly],[aO,h.EncoderOnly],[aB,h.EncoderOnly],[aT,h.Vision2Seq],[aI,h.EncoderOnly],[aG,h.EncoderOnly],[aV,h.EncoderOnly],[aU,h.EncoderOnly],[aX,h.EncoderOnly],[aK,h.EncoderOnly],[aq,h.EncoderOnly],[aN,h.EncoderOnly],[az,h.MaskGeneration],[aj,h.EncoderOnly],[aW,h.EncoderOnly],[aC,h.Seq2Seq],[aF,h.EncoderOnly],[aR,h.EncoderOnly],[aQ,h.EncoderOnly]];for(let[e,s]of aH)for(let[t,n]of e.values())m.set(t,s),g.set(n,t),p.set(t,n);for(let[e,s,t]of[["CLIPTextModelWithProjection",sj,h.EncoderOnly],["CLIPVisionModelWithProjection",sW,h.EncoderOnly],["SiglipTextModel",sU,h.EncoderOnly],["SiglipVisionModel",sX,h.EncoderOnly],["ClapTextModelWithProjection",au,h.EncoderOnly],["ClapAudioModelWithProjection",ah,h.EncoderOnly]])m.set(e,t),g.set(s,e),p.set(e,s);class aJ extends aM{}aJ.MODEL_CLASS_MAPPINGS=aH.map(e=>e[0]),aJ.BASE_IF_FAIL=!0;class a$ extends aM{}a$.MODEL_CLASS_MAPPINGS=[aL];class aZ extends aM{}aZ.MODEL_CLASS_MAPPINGS=[aA];class aY extends aM{}aY.MODEL_CLASS_MAPPINGS=[aP];class a0 extends aM{}a0.MODEL_CLASS_MAPPINGS=[aS];class a2 extends aM{}a2.MODEL_CLASS_MAPPINGS=[aC];class a1 extends aM{}a1.MODEL_CLASS_MAPPINGS=[aF];class a3 extends aM{}a3.MODEL_CLASS_MAPPINGS=[aE];class a5 extends aM{}a5.MODEL_CLASS_MAPPINGS=[aO];class a4 extends aM{}a4.MODEL_CLASS_MAPPINGS=[aB];class a6 extends aM{}a6.MODEL_CLASS_MAPPINGS=[aT];class a8 extends aM{}a8.MODEL_CLASS_MAPPINGS=[aI];class a7 extends aM{}a7.MODEL_CLASS_MAPPINGS=[aG];class a9 extends aM{}a9.MODEL_CLASS_MAPPINGS=[aV];class ie extends aM{}ie.MODEL_CLASS_MAPPINGS=[aq];class is extends aM{}is.MODEL_CLASS_MAPPINGS=[aN];class it extends aM{}it.MODEL_CLASS_MAPPINGS=[az];class ia extends aM{}ia.MODEL_CLASS_MAPPINGS=[aj];class ii extends aM{}ii.MODEL_CLASS_MAPPINGS=[aW];class io extends aM{}io.MODEL_CLASS_MAPPINGS=[aR];class ir extends aM{}ir.MODEL_CLASS_MAPPINGS=[aQ];class il extends aM{}il.MODEL_CLASS_MAPPINGS=[aD];class ic extends aM{}ic.MODEL_CLASS_MAPPINGS=[aU];class id extends aM{}id.MODEL_CLASS_MAPPINGS=[aX];class i_ extends aM{}i_.MODEL_CLASS_MAPPINGS=[aK];class iu extends O{constructor({logits:e,past_key_values:s,encoder_outputs:t,decoder_attentions:n=null,cross_attentions:a=null}){super(),this.logits=e,this.past_key_values=s,this.encoder_outputs=t,this.decoder_attentions=n,this.cross_attentions=a}}class ih extends O{constructor({logits:e}){super(),this.logits=e}}class im extends O{constructor({logits:e,embeddings:s}){super(),this.logits=e,this.embeddings=s}}class ip extends O{constructor({logits:e}){super(),this.logits=e}}class ig extends O{constructor({logits:e}){super(),this.logits=e}}class iw extends O{constructor({start_logits:e,end_logits:s}){super(),this.start_logits=e,this.end_logits=s}}class ix extends O{constructor({logits:e}){super(),this.logits=e}}class iy extends O{constructor({alphas:e}){super(),this.alphas=e}}class iM extends O{constructor({waveform:e,spectrogram:s}){super(),this.waveform=e,this.spectrogram=s}}}}]);